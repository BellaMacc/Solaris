<html>
<head>
  <!-- Circles' head scripts [REQUIRED] -->
  <circles-start-scripts/>

  <!----Added libraries - Ryan-->

  <!----Added scripts - Ryan-->
</head>
<body>
  <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
  <circles-start-ui/>

  <!-- a-scene with 'circles-properties' component [REQUIRED] -->
  <a-scene circles_scene_properties physx="autoLoad: true; delay: 1000; debug: true" >
    <a-assets>

      <!-- Circles' built-in assets [REQUIRED] -->
      <circles-assets/>

      <!--put assets below here -->
      <a-asset-item id="stew-gltf" src="https://cdn.glitch.global/d29f98b4-ddd1-4589-8b66-e2446690e697/model.gltf?v=1690887932932"></a-asset-item>
      <a-asset-item id="table-gltf" src="https://cdn.glitch.global/d29f98b4-ddd1-4589-8b66-e2446690e697/small_wooden_table_01_1k-v1.glb?v=1647263187998"></a-asset-item>
      <a-asset-item id="clock-gltf" src="https://cdn.glitch.global/d29f98b4-ddd1-4589-8b66-e2446690e697/vintage_grandfather_clock_01_1k-v2.glb?v=1647265174189"></a-asset-item>
      <a-asset-item id="animation-gltf" src="assets/models/male_survivor.glb"></a-asset-item>
    </a-assets>

    <!-- Circles' built-in manager and avatar [REQUIRED] -->
    <circles-manager-avatar/> <!---------------------Put code below this--------------------->
    
    <a-entity id="survivor" scale="0.2 0.2 0.2" position="0 2 0" gltf-model="#animation-gltf" animation-mixer="loop:repeat; clip: NlaTrack"></a-entity>

      <script>
        document.querySelector('#survivor').components['animation-mixer'].data
      </script>

      <!-- control table -->
      <a-entity position="0 1 7" geometry="primitive:box; width:4; depth:1; height:0.2;" rotation="45 0 0" material="color:rgb(0, 0, 0)" shadow></a-entity>

      <!-- green button -->
      <a-entity id="start_button" position="-1 0.7 6.9">
        <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(100, 255, 100)" rotation="45 0 0"
                    animation__mouseenter="property:material.color; type:color; to:rgb(0, 255, 0); startEvents:mouseenter; dur:200"
                    animation__mouseleave="property:material.color; type:color; to:rgb(100, 255, 100); startEvents:mouseleave; dur:200"
                    animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
      </a-entity>
      
      <!-- blue button -->
      <a-entity id="next_button" position="-1.5 0.4 7.2">
          <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(100, 100, 255)" rotation="45 0 0"
                      animation__mouseenter="property:material.color; type:color; to:rgb(0, 0, 255); startEvents:mouseenter; dur:200"
                      animation__mouseleave="property:material.color; type:color; to:rgb(100, 100, 255); startEvents:mouseleave; dur:200"
                      animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
      </a-entity>

      <!-- red button -->
      <a-entity id="stop_button" position="-0.5 0.4 7.2" update-player>
        <a-entity class="button interactive" position="0 0.6 0" geometry="primitive:cylinder; radius:0.15; height:0.2;" material="color:rgb(255, 100, 100)" rotation="45 0 0"
                    animation__mouseenter="property:material.color; type:color; to:rgb(255, 0, 0); startEvents:mouseenter; dur:200"
                    animation__mouseleave="property:material.color; type:color; to:rgb(255, 100, 100); startEvents:mouseleave; dur:200"
                    animation__click="property:position.y; from:0.55; to:0.6; startEvents:click; dur:300" shadow></a-entity>
      </a-entity>

      <script>
        window.addEventListener("DOMContentLoaded", () => {
          // Select buttons
          const startButton = document.querySelector("#start_button .button");
          const nextButton = document.querySelector("#next_button .button");
          const stopButton = document.querySelector("#stop_button .button");
      
          // Select an animated entity (modify if needed)
          const animatedEntity = document.querySelector('[animation-mixer]');
      
          // Start animation
          startButton.addEventListener("click", () => {
              console.log("Start button clicked");
              if (animatedEntity) {
                  animatedEntity.setAttribute("animation-mixer", "clip: NlaTrack; loop: repeat");
              }
          });
      
          // Change to the next animation or interaction
          nextButton.addEventListener("click", () => {
              console.log("Next button clicked");
              if (animatedEntity) {
                  animatedEntity.setAttribute("animation-mixer", "clip: NlaTrack.004"); // Replace with actual animation name
              }
          });
      
          // Stop animation
          stopButton.addEventListener("click", () => {
              console.log("Stop button clicked");
              if (animatedEntity) {
                  animatedEntity.removeAttribute("animation-mixer");
              }
          });
        });
      </script>
      
    <a-entity id="my-ar-objects" position="-6 0 1">
      <!-- "Dusty Piano" (https://skfb.ly/66EPx) by Vincent074 is licensed under Creative Commons Attribution (http://creativecommons.org/licenses/by/4.0/). -->
      <a-gltf-model id="piano" rotation="0 100 0" shadow="receive:false;cast:true;" src="https://cdn.glitch.global/d29f98b4-ddd1-4589-8b66-e2446690e697/piano.glb?v=1644414775118">
        <a-plane rotation="-90 0 0" width="1.5" height="0.6" class="navmesh-hole" visible="false"></a-plane>
      </a-gltf-model>
    </a-entity>

      <a-gltf-model id="pot" toggle-physics shadow="receive:false;" src="#stew-gltf" position="-2 1.2 0.8" physx-body-from-model="type:dynamic;mass:2;">
      </a-gltf-model>

      <a-gltf-model id="table" shadow="receive:true;" src="#table-gltf" position="-2 0 0.8" rotation="0 51 0" scale="1.5 1.5 1.5" physx-body-from-model="type: static;">
        <a-plane rotation="-90 0 0" width="1.2" height="0.6" class="navmesh-hole" visible="false"></a-plane>
      </a-gltf-model>
      
      <a-gltf-model id="clock" shadow="receive:true;" src="#clock-gltf" position="-5 0 1.8" rotation="0 51 0" physx-body-from-model="type:dynamic;mass:15;"></a-gltf-model>

    <!--Primitive objects-->
    <!-- blue box -->
      <a-box position="0 2 -3"
        depth="1" height="1" width="1"
        color="#4CC3D9"
        physx-body="type: dynamic; mass: 5;"
        physx-restitution="0.8"
        shadow="cast: true; receive: true">
      </a-box>

      <!-- red box -->
      <a-box position="2 0.5 -3"
      depth="1" height="1" width="1"
      color="#FF0000"
      class="navmesh"
      physx-body="type: static;" 
      shadow="cast: true; receive: true">
      </a-box>

      <!-- nav mesh (ground) -->
      <a-box 
            class="navmesh"
            physx-body="type: static" 
            position="0 -0.5 0" 
            rotation="-90 0 0" 
            width="20" 
            height="20" 
            color="#808080" 
            visible="true">
      </a-box>

      <!-- nav mesh (ramp) -->
      <a-box 
            class="navmesh" 
            physx-body="type: static" 
            position="0 0 10" 
            rotation="-135 0 0" 
            width="20" 
            height="20" 
            color="#808080" 
            visible="true">
      </a-box>

      <!-- nav mesh (platform) -->
      <a-box 
            class="navmesh" 
            physx-body="type: static" 
            position="0 6.921 26.701" 
            rotation="-90 0 0" 
            width="20" 
            height="20" 
            color="#808080" 
            visible="true">
      </a-box>

      <!-- inaccessible square -->
      <a-entity id="wall" shadow="receive:true;" position="5 0 -3" rotation="0 0 0" scale="1.5 1.5 1.5" physx-body-from-model="type: static;">
      <a-plane rotation="-90 0 0" width="1" height="1" class="navmesh-hole" visible="true"></a-plane>
      </a-entity>

      <a-entity 
        gltf-model="#animation-gtlf"
        animation-mixer
        position="0 1 0">
      </a-entity>

  </a-scene>

  <!-- Circles' end scripts [REQUIRED] -->
  <circles-end-scripts/>
 </body>
</html>